---
import BaseHead from "../components/BaseHead.astro";
import Header from "../components/Header.astro";
import Footer from "../components/Footer.astro";
import { SITE_TITLE, SITE_DESCRIPTION, TORC_APP_URL } from "../consts";
import { Image } from "astro:assets";
import { getCollection } from "astro:content";
import FormattedDate from "@/components/FormattedDate.astro";
import barca from "../images/torc.webp";
import timer from "../images/timer.webp";
import friends from "../images/friends.webp";

import { HeroDashboard } from "@/components/landing/HeroDashboard";
import { ActivitiesDemo } from "@/components/landing/ActivitiesDemo";
import { BlocksDemo } from "@/components/landing/BlocksDemo";
import { CompareDemo } from "@/components/landing/CompareDemo";
import { CoachDemo } from "@/components/landing/CoachDemo";

const posts = (await getCollection("blog")).sort(
  (a, b) => (b.data.pubDate || 0).valueOf() - (a.data.pubDate || 0).valueOf()
);
---

<!doctype html>
<html lang="en">
  <head>
    <BaseHead title={SITE_TITLE} description={SITE_DESCRIPTION} />
  </head>
  <body class="bg-background min-h-screen flex flex-col">
    <Header />

    <main class="!w-full !max-w-none !p-0">
      <!-- Hero Section -->
      <section class="py-20 md:py-32">
        <div class="mx-auto max-w-7xl px-4">
          <div class="grid items-center gap-12 lg:gap-16 md:grid-cols-2">
            <div>
              <h1 class="text-balance text-4xl font-bold tracking-tight text-primary sm:text-5xl lg:text-6xl">
                Train smarter.<br />Run faster.
              </h1>
              <p class="mt-6 max-w-lg text-lg text-primary/70">
                AI-powered coaching and insights that turn your running data into
                faster times and smarter training.
              </p>
              <div class="mt-8 flex flex-wrap gap-4">
                <a
                  href={`${TORC_APP_URL}/login`}
                  class="inline-flex items-center justify-center rounded-md bg-primary px-6 py-3 text-sm font-medium text-primary-foreground transition-colors hover:bg-primary/90"
                >
                  Get Started Free
                </a>
                <a
                  href="/blog"
                  class="inline-flex items-center justify-center rounded-md border border-input bg-background px-6 py-3 text-sm font-medium transition-colors hover:bg-accent hover:text-accent-foreground"
                >
                  Read the Blog
                </a>
              </div>
            </div>
            <HeroDashboard client:visible />
          </div>
        </div>
      </section>

      <!-- Feature: Activities -->
      <section class="py-20 md:py-32 bg-muted/30">
        <div class="mx-auto max-w-7xl px-4">
          <div class="grid items-center gap-12 lg:gap-16 md:grid-cols-2">
            <div>
              <h2 class="text-3xl font-bold tracking-tight text-primary sm:text-4xl">
                Every run. Every metric.
              </h2>
              <p class="mt-4 text-lg text-primary/70">
                Track distance, pace, heart rate zones, elevation, and more. See your weekly trends at a glance.
              </p>
            </div>
            <ActivitiesDemo client:visible />
          </div>
        </div>
      </section>

      <!-- Feature: Blocks -->
      <section class="py-20 md:py-32">
        <div class="mx-auto max-w-7xl px-4">
          <div class="grid items-center gap-12 lg:gap-16 md:grid-cols-2">
            <div class="md:order-2">
              <h2 class="text-3xl font-bold tracking-tight text-primary sm:text-4xl">
                Structure your training.
              </h2>
              <p class="mt-4 text-lg text-primary/70">
                Organize runs into training blocks. Set goals, track volume, and see your progression week over week.
              </p>
            </div>
            <BlocksDemo client:visible />
          </div>
        </div>
      </section>

      <!-- Feature: Compare -->
      <section class="py-20 md:py-32 bg-muted/30">
        <div class="mx-auto max-w-7xl px-4">
          <div class="grid items-center gap-12 lg:gap-16 md:grid-cols-2">
            <div>
              <h2 class="text-3xl font-bold tracking-tight text-primary sm:text-4xl">
                Stack your runs.
              </h2>
              <p class="mt-4 text-lg text-primary/70">
                Compare multiple activities side by side. Spot patterns, find your fastest routes, and track improvement.
              </p>
            </div>
            <CompareDemo client:visible />
          </div>
        </div>
      </section>

      <!-- Feature: Coach -->
      <section class="py-20 md:py-32">
        <div class="mx-auto max-w-7xl px-4">
          <div class="grid items-center gap-12 lg:gap-16 md:grid-cols-2">
            <div class="md:order-2">
              <h2 class="text-3xl font-bold tracking-tight text-primary sm:text-4xl">
                AI that knows your training.
              </h2>
              <p class="mt-4 text-lg text-primary/70">
                Get AI coaching and personalized insights on every run. Ask questions, get answers grounded in your data.
              </p>
            </div>
            <CoachDemo client:visible />
          </div>
        </div>
      </section>

      <!-- From the Blog -->
      <section class="py-16 bg-muted/30">
        <div class="mx-auto max-w-7xl px-4">
          <div class="flex items-center justify-between mb-8">
            <h2 class="text-2xl font-bold tracking-tight text-primary">From the Blog</h2>
            <a href="/blog" class="text-sm font-medium text-primary/70 hover:text-primary transition-colors">
              View all &rarr;
            </a>
          </div>
          <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
            {
              posts.slice(0, 3).map((post, index) => (
                <article class="overflow-hidden rounded-lg shadow-sm transition-all hover:shadow-2xl border border-muted duration-500 group cursor-pointer">
                  <a href={`/blog/${post.slug}/`}>
                    <div class="overflow-hidden">
                      <Image
                        src={post.data.heroImage}
                        alt=""
                        width={800}
                        height={224}
                        class="h-48 w-full object-cover group-hover:scale-110 transition-all duration-500"
                        format="webp"
                        quality={80}
                        loading={index < 2 ? "eager" : "lazy"}
                      />
                    </div>
                    <div class="bg-card p-4 sm:p-6">
                      {post.data.pubDate && (
                        <time
                          datetime={post.data.pubDate.toString()}
                          class="block text-xs text-gray-500"
                        >
                          <FormattedDate date={post.data.pubDate} />
                        </time>
                      )}
                      <h3 class="mt-0.5 text-lg text-foreground">{post.data.title}</h3>
                      {post.data.description && (
                        <p class="mt-2 line-clamp-2 text-sm/relaxed text-secondary-foreground">
                          {post.data.description}
                        </p>
                      )}
                    </div>
                  </a>
                </article>
              ))
            }
          </div>
        </div>
      </section>

      <!-- Free Running Tools -->
      <section class="py-16">
        <div class="mx-auto max-w-7xl px-4">
          <div class="flex items-center justify-between mb-8">
            <h2 class="text-2xl font-bold tracking-tight text-primary">Free Running Tools</h2>
            <a href="/tools" class="text-sm font-medium text-primary/70 hover:text-primary transition-colors">
              View all &rarr;
            </a>
          </div>
          <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
            <a
              href="/tools/pace-review/"
              class="relative overflow-hidden rounded-lg shadow-sm transition-shadow hover:shadow-2xl group"
            >
              <Image
                src={barca}
                alt="Race Day Ready tool"
                format="webp"
                quality={80}
                class="absolute inset-0 h-full w-full object-cover group-hover:scale-110 transition-transform duration-500"
              />
              <div class="relative bg-linear-to-t from-gray-900/60 to-gray-900/20 pt-32 sm:pt-48">
                <div class="p-4 sm:p-6">
                  <h3 class="text-white font-extrabold text-2xl">Race Day Ready</h3>
                  <p class="text-white/80 text-sm mt-1">Review your race pacing strategy</p>
                </div>
              </div>
            </a>
            <a
              href="/tools/pace-calculator"
              class="relative overflow-hidden rounded-lg shadow-sm transition-shadow hover:shadow-2xl group"
            >
              <Image
                src={timer}
                alt="Pace Calculator tool"
                format="webp"
                quality={80}
                class="absolute inset-0 h-full w-full object-cover group-hover:scale-110 transition-transform duration-500"
              />
              <div class="relative bg-linear-to-t from-gray-900/60 to-gray-900/20 pt-32 sm:pt-48">
                <div class="p-4 sm:p-6">
                  <h3 class="text-white font-extrabold text-2xl">Pace Calculator</h3>
                  <p class="text-white/80 text-sm mt-1">Calculate splits for any distance</p>
                </div>
              </div>
            </a>
            <a
              href="/tools/runshare/"
              class="relative overflow-hidden rounded-lg shadow-sm transition-shadow hover:shadow-2xl group"
            >
              <Image
                src={friends}
                alt="Social Card Builder tool"
                format="webp"
                quality={80}
                class="absolute inset-0 h-full w-full object-cover group-hover:scale-110 transition-transform duration-500"
              />
              <div class="relative bg-linear-to-t from-gray-900/60 to-gray-900/20 pt-32 sm:pt-48">
                <div class="p-4 sm:p-6">
                  <h3 class="text-white font-extrabold text-2xl">Social Card Builder</h3>
                  <p class="text-white/80 text-sm mt-1">Share your runs on social media</p>
                </div>
              </div>
            </a>
          </div>
        </div>
      </section>
    </main>

    <Footer />
  </body>
</html>
